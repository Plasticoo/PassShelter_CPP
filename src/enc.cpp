#include <stdio.h>
#include <stdint.h>
#include <stdlib.h>

#include "aes.h"

// print encrypted key
void print_encripted_key(uint8_t buffer[], int b_size)
{
	int i;

	for (i = 0; i < b_size; i++) 
	{
		printf("%.2x", buffer[i]);
	}	

	putchar('\n');
}

//test encryption example function
void aes_encrypt_cbc()
{
	// 16 byte key
	uint8_t key[16] = {0x2b, 0x21, 0x32, 0x10, 0x3d, 0x3e, 0xf4, 0x32, 0x32, 0x33, 0xff, 0x54, 0x32, 0xf3, 0xff, 0xfd};

	// 16 byte IV
	uint8_t iv[16] = {0x21, 0x21, 0x31, 0x11, 0x31, 0x31, 0xf1, 0x31, 0x31, 0x31, 0xf1, 0x51, 0x31, 0xf1, 0xf2, 0xf2};

	// 64 byte word
	uint8_t word[64] = {0x3b, 0x41, 0x52, 0x70, 0x8d, 0xae, 0xe4, 0xd2, 0x39, 0x31, 0x2f, 0x34, 0x72, 0x03, 0xdf, 0xdd,
		0x3b, 0x41, 0x52, 0x70, 0x8d, 0xae, 0xe4, 0xd2, 0x39, 0x31, 0x2f, 0x34, 0x72, 0x03, 0xdf, 0xdd,
		0x3b, 0x41, 0x52, 0x70, 0x8d, 0xae, 0xe4, 0xd2, 0x39, 0x31, 0x2f, 0x34, 0x72, 0x03, 0xdf, 0xdd,
		0x3b, 0x41, 0x52, 0x70, 0x8d, 0xae, 0xe4, 0xd2, 0x39, 0x31, 0x2f, 0x34, 0x72, 0x03, 0xdf, 0xdd};

	uint8_t buffer[64];

	AES128_CBC_encrypt_buffer(buffer, word, 64, key, iv);

	print_encripted_key(buffer, 64);
}
